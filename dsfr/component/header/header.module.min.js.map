{"version":3,"file":"header.module.min.js","sources":["../../../.config/config.js","../../../src/dsfr/core/api.js","../../../src/dsfr/component/header/script/header/header-selector.js","../../../src/dsfr/component/header/script/header/header-links.js","../../../src/dsfr/component/header/script/header/header-modal.js","../../../src/dsfr/component/header/index.js","../../../src/dsfr/component/header/main.js"],"sourcesContent":["const config = {\r\n  prefix: 'fr',\r\n  namespace: 'dsfr',\r\n  organisation: '@gouvfr',\r\n  version: '1.14.2'\r\n};\r\n\r\nexport default config;\r\n","import config from './config.js';\nconst api = window[config.namespace];\nexport default api;\n","import api from '../../api.js';\n\nexport const HeaderSelector = {\n  HEADER: api.internals.ns.selector('header'),\n  BRAND_LINK: api.internals.ns.selector('header__brand a'),\n  TOOLS_LINKS: api.internals.ns.selector('header__tools-links'),\n  MENU_LINKS: api.internals.ns.selector('header__menu-links'),\n  BUTTONS: `${api.internals.ns.selector('header__tools-links')} ${api.internals.ns.selector('btns-group')}, ${api.internals.ns.selector('header__tools-links')} ${api.internals.ns.selector('links-group')}`,\n  MODALS: `${api.internals.ns.selector('header__search')}${api.internals.ns.selector('modal')}, ${api.internals.ns.selector('header__menu')}${api.internals.ns.selector('modal')}`\n};\n","import api from '../../api.js';\nimport { HeaderSelector } from './header-selector.js';\n\nclass HeaderLinks extends api.core.Instance {\n  static get instanceClassName () {\n    return 'HeaderLinks';\n  }\n\n  init () {\n    const header = this.queryParentSelector(HeaderSelector.HEADER);\n    this.toolsLinks = header.querySelector(HeaderSelector.TOOLS_LINKS);\n    this.menuLinks = header.querySelector(HeaderSelector.MENU_LINKS);\n    const copySuffix = '-mobile';\n\n    const toolsHtml = this.toolsLinks.innerHTML.replace(/  +/g, ' ');\n    const menuHtml = this.menuLinks.innerHTML.replace(/  +/g, ' ');\n    // Pour éviter de dupliquer des id, on ajoute un suffixe aux id et aria-controls duppliqués.\n    let toolsHtmlIdList = toolsHtml.match(/id=\"(.*?)\"/gm) || [];\n\n    // on a besoin d'échapper les backslash dans la chaine de caractère\n    // eslint-disable-next-line no-useless-escape\n    toolsHtmlIdList = toolsHtmlIdList.map(element => element.replace('id=\\\"', '').replace('\\\"', ''));\n\n    const dupplicateAttributes = ['aria-controls', 'aria-describedby', 'aria-labelledby'];\n\n    let toolsHtmlDuplicateId = toolsHtml.replace(/id=\"(.*?)\"/gm, `id=\"$1${copySuffix}\"`);\n\n    for (const attribute of dupplicateAttributes) {\n      const toolsHtmlAttributeList = toolsHtml.match(new RegExp(`${attribute}=\"(.*?)\"`, 'gm'));\n      if (toolsHtmlAttributeList) {\n        for (const element of toolsHtmlAttributeList) {\n          const attributeValue = element.replace(`${attribute}=\"`, '').replace('\"', '');\n          if (toolsHtmlIdList.includes(attributeValue)) {\n            toolsHtmlDuplicateId = toolsHtmlDuplicateId.replace(`${attribute}=\"${attributeValue}\"`, `${attribute}=\"${attributeValue + copySuffix}\"`);\n          };\n        }\n      }\n    }\n\n    if (toolsHtmlDuplicateId === menuHtml) return;\n\n    switch (api.mode) {\n      case api.Modes.ANGULAR:\n      case api.Modes.REACT:\n      case api.Modes.VUE:\n        this.warn(`header__tools-links content is different from header__menu-links content.\nAs you're using a dynamic framework, you should handle duplication of this content yourself, please refer to documentation:\n${api.header.doc}`);\n        break;\n\n      default:\n        this.menuLinks.innerHTML = toolsHtmlDuplicateId;\n    }\n  }\n}\n\nexport { HeaderLinks };\n","import api from '../../api.js';\n\nclass HeaderModal extends api.core.Instance {\n  static get instanceClassName () {\n    return 'HeaderModal';\n  }\n\n  init () {\n    this.storeAria();\n    this.isResizing = true;\n  }\n\n  resize () {\n    if (this.isBreakpoint(api.core.Breakpoints.LG)) this.deactivateModal();\n    else this.activateModal();\n  }\n\n  activateModal () {\n    const modal = this.element.getInstance('Modal');\n    if (!modal) {\n      this.request(this.activateModal.bind(this));\n      return;\n    }\n    this.restoreAria();\n    modal.isActive = true;\n    this.listenClick({ capture: true });\n  }\n\n  deactivateModal () {\n    const modal = this.element.getInstance('Modal');\n    if (!modal) {\n      this.request(this.deactivateModal.bind(this));\n      return;\n    }\n    modal.conceal();\n    modal.isActive = false;\n    this.storeAria();\n    this.unlistenClick({ capture: true });\n  }\n\n  storeAria () {\n    if (this.hasAttribute('aria-labelledby')) this._ariaLabelledby = this.getAttribute('aria-labelledby');\n    if (this.hasAttribute('aria-label')) this._ariaLabel = this.getAttribute('aria-label');\n    this.removeAttribute('aria-labelledby');\n    this.removeAttribute('aria-label');\n  }\n\n  restoreAria () {\n    if (this._ariaLabelledby) this.setAttribute('aria-labelledby', this._ariaLabelledby);\n    if (this._ariaLabel) this.setAttribute('aria-label', this._ariaLabel);\n  }\n\n  handleClick (e) {\n    if (e.target.matches('a, button') && !e.target.matches('[aria-controls]') && !e.target.matches(api.core.DisclosureSelector.PREVENT_CONCEAL)) {\n      const modal = this.element.getInstance('Modal');\n      modal.conceal();\n    }\n  }\n}\n\nexport { HeaderModal };\n","import api from './api.js';\nimport { HeaderLinks } from './script/header/header-links.js';\nimport { HeaderModal } from './script/header/header-modal.js';\nimport { HeaderSelector } from './script/header/header-selector.js';\n\napi.header = {\n  HeaderLinks: HeaderLinks,\n  HeaderModal: HeaderModal,\n  HeaderSelector: HeaderSelector,\n  doc: 'https://www.systeme-de-design.gouv.fr/version-courante/fr/composants/en-tete'\n};\n\nexport default api;\n","import api from './index.js';\n\napi.internals.register(api.header.HeaderSelector.TOOLS_LINKS, api.header.HeaderLinks);\napi.internals.register(api.header.HeaderSelector.MODALS, api.header.HeaderModal);\n\nexport default api;\n"],"names":["api","window","HeaderSelector","HEADER","internals","ns","selector","BRAND_LINK","TOOLS_LINKS","MENU_LINKS","BUTTONS","MODALS","HeaderLinks","core","Instance","instanceClassName","init","header","this","queryParentSelector","toolsLinks","querySelector","menuLinks","copySuffix","toolsHtml","innerHTML","replace","menuHtml","toolsHtmlIdList","match","map","element","dupplicateAttributes","toolsHtmlDuplicateId","attribute","toolsHtmlAttributeList","RegExp","attributeValue","includes","mode","Modes","ANGULAR","REACT","VUE","warn","doc","HeaderModal","storeAria","isResizing","resize","isBreakpoint","Breakpoints","LG","deactivateModal","activateModal","modal","getInstance","restoreAria","isActive","listenClick","capture","request","bind","conceal","unlistenClick","hasAttribute","_ariaLabelledby","getAttribute","_ariaLabel","removeAttribute","setAttribute","handleClick","e","target","matches","DisclosureSelector","PREVENT_CONCEAL","register"],"mappings":";AAAA,MCCMA,EAAMC,OAAuB,KCCtBC,EAAiB,CAC5BC,OAAQH,EAAII,UAAUC,GAAGC,SAAS,UAClCC,WAAYP,EAAII,UAAUC,GAAGC,SAAS,mBACtCE,YAAaR,EAAII,UAAUC,GAAGC,SAAS,uBACvCG,WAAYT,EAAII,UAAUC,GAAGC,SAAS,sBACtCI,QAAS,GAAGV,EAAII,UAAUC,GAAGC,SAAS,0BAA0BN,EAAII,UAAUC,GAAGC,SAAS,kBAAkBN,EAAII,UAAUC,GAAGC,SAAS,0BAA0BN,EAAII,UAAUC,GAAGC,SAAS,iBAC1LK,OAAQ,GAAGX,EAAII,UAAUC,GAAGC,SAAS,oBAAoBN,EAAII,UAAUC,GAAGC,SAAS,aAAaN,EAAII,UAAUC,GAAGC,SAAS,kBAAkBN,EAAII,UAAUC,GAAGC,SAAS,YCLxK,MAAMM,UAAoBZ,EAAIa,KAAKC,SACjC,4BAAWC,GACT,MAAO,aACR,CAED,IAAAC,GACE,MAAMC,EAASC,KAAKC,oBAAoBjB,EAAeC,QACvDe,KAAKE,WAAaH,EAAOI,cAAcnB,EAAeM,aACtDU,KAAKI,UAAYL,EAAOI,cAAcnB,EAAeO,YACrD,MAAMc,EAAa,UAEbC,EAAYN,KAAKE,WAAWK,UAAUC,QAAQ,OAAQ,KACtDC,EAAWT,KAAKI,UAAUG,UAAUC,QAAQ,OAAQ,KAE1D,IAAIE,EAAkBJ,EAAUK,MAAM,iBAAmB,GAIzDD,EAAkBA,EAAgBE,IAAIC,GAAWA,EAAQL,QAAQ,OAAS,IAAIA,QAAQ,IAAM,KAE5F,MAAMM,EAAuB,CAAC,gBAAiB,mBAAoB,mBAEnE,IAAIC,EAAuBT,EAAUE,QAAQ,eAAgB,SAASH,MAEtE,IAAK,MAAMW,KAAaF,EAAsB,CAC5C,MAAMG,EAAyBX,EAAUK,MAAM,IAAIO,OAAO,GAAGF,YAAqB,OAClF,GAAIC,EACF,IAAK,MAAMJ,KAAWI,EAAwB,CAC5C,MAAME,EAAiBN,EAAQL,QAAQ,GAAGQ,MAAe,IAAIR,QAAQ,IAAK,IACtEE,EAAgBU,SAASD,KAC3BJ,EAAuBA,EAAqBP,QAAQ,GAAGQ,MAAcG,KAAmB,GAAGH,MAAcG,EAAiBd,MAE7H,CAEJ,CAED,GAAIU,IAAyBN,EAE7B,OAAQ3B,EAAIuC,MACV,KAAKvC,EAAIwC,MAAMC,QACf,KAAKzC,EAAIwC,MAAME,MACf,KAAK1C,EAAIwC,MAAMG,IACbzB,KAAK0B,KAAK,2MAEhB5C,EAAIiB,OAAO4B,OACL,MAEF,QACE3B,KAAKI,UAAUG,UAAYQ,EAEhC,ECnDH,MAAMa,UAAoB9C,EAAIa,KAAKC,SACjC,4BAAWC,GACT,MAAO,aACR,CAED,IAAAC,GACEE,KAAK6B,YACL7B,KAAK8B,YAAa,CACnB,CAED,MAAAC,GACM/B,KAAKgC,aAAalD,EAAIa,KAAKsC,YAAYC,IAAKlC,KAAKmC,kBAChDnC,KAAKoC,eACX,CAED,aAAAA,GACE,MAAMC,EAAQrC,KAAKa,QAAQyB,YAAY,SAClCD,GAILrC,KAAKuC,cACLF,EAAMG,UAAW,EACjBxC,KAAKyC,YAAY,CAAEC,SAAS,KAL1B1C,KAAK2C,QAAQ3C,KAAKoC,cAAcQ,KAAK5C,MAMxC,CAED,eAAAmC,GACE,MAAME,EAAQrC,KAAKa,QAAQyB,YAAY,SAClCD,GAILA,EAAMQ,UACNR,EAAMG,UAAW,EACjBxC,KAAK6B,YACL7B,KAAK8C,cAAc,CAAEJ,SAAS,KAN5B1C,KAAK2C,QAAQ3C,KAAKmC,gBAAgBS,KAAK5C,MAO1C,CAED,SAAA6B,GACM7B,KAAK+C,aAAa,qBAAoB/C,KAAKgD,gBAAkBhD,KAAKiD,aAAa,oBAC/EjD,KAAK+C,aAAa,gBAAe/C,KAAKkD,WAAalD,KAAKiD,aAAa,eACzEjD,KAAKmD,gBAAgB,mBACrBnD,KAAKmD,gBAAgB,aACtB,CAED,WAAAZ,GACMvC,KAAKgD,iBAAiBhD,KAAKoD,aAAa,kBAAmBpD,KAAKgD,iBAChEhD,KAAKkD,YAAYlD,KAAKoD,aAAa,aAAcpD,KAAKkD,WAC3D,CAED,WAAAG,CAAaC,GACX,GAAIA,EAAEC,OAAOC,QAAQ,eAAiBF,EAAEC,OAAOC,QAAQ,qBAAuBF,EAAEC,OAAOC,QAAQ1E,EAAIa,KAAK8D,mBAAmBC,iBAAkB,CAC7H1D,KAAKa,QAAQyB,YAAY,SACjCO,SACP,CACF,ECpDH/D,EAAIiB,OAAS,CACXL,YAAaA,EACbkC,YAAaA,EACb5C,eAAgBA,EAChB2C,IAAK,gFCPP7C,EAAII,UAAUyE,SAAS7E,EAAIiB,OAAOf,eAAeM,YAAaR,EAAIiB,OAAOL,aACzEZ,EAAII,UAAUyE,SAAS7E,EAAIiB,OAAOf,eAAeS,OAAQX,EAAIiB,OAAO6B"}