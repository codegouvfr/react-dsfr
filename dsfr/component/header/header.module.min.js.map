{"version":3,"file":"header.module.min.js","sources":["../../../.config/config.js","../../../src/core/api.js","../../../src/component/header/script/header/header-selector.js","../../../src/component/header/script/header/header-links.js","../../../src/component/header/script/header/header-modal.js","../../../src/component/header/index.js","../../../src/component/header/main.js"],"sourcesContent":["const config = {\r\n  prefix: 'fr',\r\n  namespace: 'dsfr',\r\n  organisation: '@gouvfr',\r\n  version: '1.9.1'\r\n};\r\n\r\nexport default config;\r\n","import config from './config.js';\nconst api = window[config.namespace];\nexport default api;\n","import api from '../../api.js';\n\nexport const HeaderSelector = {\n  HEADER: api.internals.ns.selector('header'),\n  TOOLS_LINKS: api.internals.ns.selector('header__tools-links'),\n  MENU_LINKS: api.internals.ns.selector('header__menu-links'),\n  BUTTONS: `${api.internals.ns.selector('header__tools-links')} ${api.internals.ns.selector('btns-group')}, ${api.internals.ns.selector('header__tools-links')} ${api.internals.ns.selector('links-group')}`,\n  MODALS: `${api.internals.ns.selector('header__search')}${api.internals.ns.selector('modal')}, ${api.internals.ns.selector('header__menu')}${api.internals.ns.selector('modal')}`\n};\n","import api from '../../api.js';\nimport { HeaderSelector } from './header-selector.js';\n\nclass HeaderLinks extends api.core.Instance {\n  static get instanceClassName () {\n    return 'HeaderLinks';\n  }\n\n  init () {\n    const header = this.queryParentSelector(HeaderSelector.HEADER);\n    this.toolsLinks = header.querySelector(HeaderSelector.TOOLS_LINKS);\n    this.menuLinks = header.querySelector(HeaderSelector.MENU_LINKS);\n    const copySuffix = '-mobile';\n\n    const toolsHtml = this.toolsLinks.innerHTML.replace(/  +/g, ' ');\n    const menuHtml = this.menuLinks.innerHTML.replace(/  +/g, ' ');\n    // Pour éviter de dupliquer des id, on ajoute un suffixe aux id et aria-controls duppliqués.\n    let toolsHtmlDuplicateId = toolsHtml.replace(/(<nav[.\\s\\S]*-translate [.\\s\\S]*) id=\"(.*?)\"([.\\s\\S]*<\\/nav>)/gm, '$1 id=\"$2' + copySuffix + '\"$3');\n    toolsHtmlDuplicateId = toolsHtmlDuplicateId.replace(/(<nav[.\\s\\S]*-translate [.\\s\\S]*) aria-controls=\"(.*?)\"([.\\s\\S]*<\\/nav>)/gm, '$1 aria-controls=\"$2' + copySuffix + '\"$3');\n\n    if (toolsHtmlDuplicateId === menuHtml) return;\n\n    switch (api.mode) {\n      case api.Modes.ANGULAR:\n      case api.Modes.REACT:\n      case api.Modes.VUE:\n        api.inspector.warn(`header__tools-links content is different from header__menu-links content.\nAs you're using a dynamic framework, you should handle duplication of this content yourself, please refer to documentation:\n${api.header.doc}`);\n        break;\n\n      default:\n        this.menuLinks.innerHTML = toolsHtmlDuplicateId;\n    }\n  }\n}\n\nexport { HeaderLinks };\n","import api from '../../api.js';\n\nclass HeaderModal extends api.core.Instance {\n  constructor () {\n    super();\n    this._clickHandling = this.clickHandler.bind(this);\n  }\n\n  static get instanceClassName () {\n    return 'HeaderModal';\n  }\n\n  init () {\n    this.isResizing = true;\n  }\n\n  resize () {\n    if (this.isBreakpoint(api.core.Breakpoints.LG)) this.unqualify();\n    else this.qualify();\n  }\n\n  qualify () {\n    this.setAttribute('role', 'dialog');\n    const modal = this.element.getInstance('Modal');\n    if (!modal) return;\n    const buttons = modal.buttons;\n    let id = '';\n    for (const button of buttons) {\n      id = button.id || id;\n      if (button.isPrimary && id) break;\n    }\n    this.setAttribute('aria-labelledby', id);\n    this.listen('click', this._clickHandling, { capture: true });\n  }\n\n  unqualify () {\n    const modal = this.element.getInstance('Modal');\n    if (modal) modal.conceal();\n    this.removeAttribute('role');\n    this.removeAttribute('aria-labelledby');\n    this.unlisten('click', this._clickHandling, { capture: true });\n  }\n\n  clickHandler (e) {\n    if (e.target.matches('a, button') && !e.target.matches('[aria-controls]') && !e.target.matches(api.core.DisclosureSelector.PREVENT_CONCEAL)) {\n      const modal = this.element.getInstance('Modal');\n      modal.conceal();\n    }\n  }\n}\n\nexport { HeaderModal };\n","import api from './api.js';\nimport { HeaderLinks } from './script/header/header-links.js';\nimport { HeaderModal } from './script/header/header-modal.js';\nimport { HeaderSelector } from './script/header/header-selector.js';\n\napi.header = {\n  HeaderLinks: HeaderLinks,\n  HeaderModal: HeaderModal,\n  HeaderSelector: HeaderSelector,\n  doc: 'https://www.systeme-de-design.gouv.fr/elements-d-interface/composants/en-tete'\n};\n\nexport default api;\n","import api from './index.js';\n\napi.internals.register(api.header.HeaderSelector.TOOLS_LINKS, api.header.HeaderLinks);\napi.internals.register(api.header.HeaderSelector.MODALS, api.header.HeaderModal);\n\nexport default api;\n"],"names":["api","window","HeaderSelector","HEADER","internals","ns","selector","TOOLS_LINKS","MENU_LINKS","BUTTONS","MODALS","HeaderLinks","core","Instance","instanceClassName","init","header","this","queryParentSelector","toolsLinks","querySelector","menuLinks","toolsHtml","innerHTML","replace","menuHtml","toolsHtmlDuplicateId","mode","Modes","ANGULAR","REACT","VUE","inspector","warn","doc","HeaderModal","constructor","super","_clickHandling","clickHandler","bind","isResizing","resize","isBreakpoint","Breakpoints","LG","unqualify","qualify","setAttribute","modal","element","getInstance","buttons","id","button","isPrimary","listen","capture","conceal","removeAttribute","unlisten","e","target","matches","DisclosureSelector","PREVENT_CONCEAL","register"],"mappings":";AAAA,MCCMA,EAAMC,OAAuB,KCCtBC,EAAiB,CAC5BC,OAAQH,EAAII,UAAUC,GAAGC,SAAS,UAClCC,YAAaP,EAAII,UAAUC,GAAGC,SAAS,uBACvCE,WAAYR,EAAII,UAAUC,GAAGC,SAAS,sBACtCG,QAAS,GAAGT,EAAII,UAAUC,GAAGC,SAAS,0BAA0BN,EAAII,UAAUC,GAAGC,SAAS,kBAAkBN,EAAII,UAAUC,GAAGC,SAAS,0BAA0BN,EAAII,UAAUC,GAAGC,SAAS,iBAC1LI,OAAQ,GAAGV,EAAII,UAAUC,GAAGC,SAAS,oBAAoBN,EAAII,UAAUC,GAAGC,SAAS,aAAaN,EAAII,UAAUC,GAAGC,SAAS,kBAAkBN,EAAII,UAAUC,GAAGC,SAAS,YCJxK,MAAMK,UAAoBX,EAAIY,KAAKC,SACtBC,+BACT,MAAO,cAGTC,OACE,MAAMC,EAASC,KAAKC,oBAAoBhB,EAAeC,QACvDc,KAAKE,WAAaH,EAAOI,cAAclB,EAAeK,aACtDU,KAAKI,UAAYL,EAAOI,cAAclB,EAAeM,YACrD,MAEMc,EAAYL,KAAKE,WAAWI,UAAUC,QAAQ,OAAQ,KACtDC,EAAWR,KAAKI,UAAUE,UAAUC,QAAQ,OAAQ,KAE1D,IAAIE,EAAuBJ,EAAUE,QAAQ,kEAAmE,uBAGhH,GAFAE,EAAuBA,EAAqBF,QAAQ,6EAA8E,kCAE9HE,IAAyBD,EAE7B,OAAQzB,EAAI2B,MACV,KAAK3B,EAAI4B,MAAMC,QACf,KAAK7B,EAAI4B,MAAME,MACf,KAAK9B,EAAI4B,MAAMG,IACb/B,EAAIgC,UAAUC,KAAK,2MAEzBjC,EAAIgB,OAAOkB,OACL,MAEF,QACEjB,KAAKI,UAAUE,UAAYG,IC9BnC,MAAMS,UAAoBnC,EAAIY,KAAKC,SACjCuB,cACEC,QACApB,KAAKqB,eAAiBrB,KAAKsB,aAAaC,KAAKvB,MAGpCH,+BACT,MAAO,cAGTC,OACEE,KAAKwB,YAAa,EAGpBC,SACMzB,KAAK0B,aAAa3C,EAAIY,KAAKgC,YAAYC,IAAK5B,KAAK6B,YAChD7B,KAAK8B,UAGZA,UACE9B,KAAK+B,aAAa,OAAQ,UAC1B,MAAMC,EAAQhC,KAAKiC,QAAQC,YAAY,SACvC,IAAKF,EAAO,OACZ,MAAMG,EAAUH,EAAMG,QACtB,IAAIC,EAAK,GACT,IAAK,MAAMC,KAAUF,EAEnB,GADAC,EAAKC,EAAOD,IAAMA,EACdC,EAAOC,WAAaF,EAAI,MAE9BpC,KAAK+B,aAAa,kBAAmBK,GACrCpC,KAAKuC,OAAO,QAASvC,KAAKqB,eAAgB,CAAEmB,SAAS,IAGvDX,YACE,MAAMG,EAAQhC,KAAKiC,QAAQC,YAAY,SACnCF,GAAOA,EAAMS,UACjBzC,KAAK0C,gBAAgB,QACrB1C,KAAK0C,gBAAgB,mBACrB1C,KAAK2C,SAAS,QAAS3C,KAAKqB,eAAgB,CAAEmB,SAAS,IAGzDlB,aAAcsB,GACZ,GAAIA,EAAEC,OAAOC,QAAQ,eAAiBF,EAAEC,OAAOC,QAAQ,qBAAuBF,EAAEC,OAAOC,QAAQ/D,EAAIY,KAAKoD,mBAAmBC,iBAAkB,CAC7HhD,KAAKiC,QAAQC,YAAY,SACjCO,YCzCZ1D,EAAIgB,OAAS,CACXL,YAAaA,EACbwB,YAAaA,EACbjC,eAAgBA,EAChBgC,IAAK,iFCPPlC,EAAII,UAAU8D,SAASlE,EAAIgB,OAAOd,eAAeK,YAAaP,EAAIgB,OAAOL,aACzEX,EAAII,UAAU8D,SAASlE,EAAIgB,OAAOd,eAAeQ,OAAQV,EAAIgB,OAAOmB"}