{"version":3,"file":"navigation.nomodule.min.js","sources":["../../../.config/config.js","../../../src/dsfr/core/api.js","../../../src/dsfr/component/navigation/script/navigation/navigation-selector.js","../../../src/dsfr/component/navigation/script/navigation/navigation-item.js","../../../src/dsfr/component/navigation/script/navigation/navigation-mouse-position.js","../../../src/dsfr/component/navigation/script/navigation/navigation.js","../../../src/dsfr/component/navigation/index.js","../../../src/dsfr/component/navigation/main.js"],"sourcesContent":["const config = {\r\n  prefix: 'fr',\r\n  namespace: 'dsfr',\r\n  organisation: '@gouvfr',\r\n  version: '1.14.2'\r\n};\r\n\r\nexport default config;\r\n","import config from './config.js';\nconst api = window[config.namespace];\nexport default api;\n","import api from '../../api.js';\n\nconst ITEM = api.internals.ns.selector('nav__item');\nconst COLLAPSE = api.internals.ns.selector('collapse');\n\nexport const NavigationSelector = {\n  NAVIGATION: api.internals.ns.selector('nav'),\n  COLLAPSE: `${ITEM} > ${COLLAPSE}, ${ITEM} > *:not(${ITEM}):not(${COLLAPSE}) > ${COLLAPSE}, ${ITEM} > *:not(${ITEM}):not(${COLLAPSE}) > *:not(${ITEM}):not(${COLLAPSE}) > ${COLLAPSE}`,\n  COLLAPSE_LEGACY: `${ITEM} ${COLLAPSE}`,\n  ITEM: ITEM,\n  ITEM_RIGHT: `${ITEM}--align-right`,\n  MENU: api.internals.ns.selector('menu'),\n  BUTTON: api.internals.ns.selector('nav__btn'),\n  TRANSLATE_BUTTON: api.internals.ns.selector('translate__btn')\n};\n","import api from '../../api.js';\nimport { NavigationSelector } from './navigation-selector.js';\n\nclass NavigationItem extends api.core.Instance {\n  constructor () {\n    super();\n    this._isRightAligned = false;\n  }\n\n  static get instanceClassName () {\n    return 'NavigationItem';\n  }\n\n  init () {\n    this.addAscent(api.core.DisclosureEmission.ADDED, this.calculate.bind(this));\n    this.addAscent(api.core.DisclosureEmission.REMOVED, this.calculate.bind(this));\n    this.isResizing = true;\n    this.calculate();\n  }\n\n  resize () {\n    this.calculate();\n  }\n\n  calculate () {\n    const collapse = this.element.getDescendantInstances(api.core.Collapse.instanceClassName, null, true)[0];\n    if (collapse && this.isBreakpoint(api.core.Breakpoints.LG) && collapse.element.node.matches(NavigationSelector.MENU)) {\n      const right = this.element.node.parentElement.getBoundingClientRect().right; // todo: ne fonctionne que si la nav fait 100% du container\n      const width = collapse.element.node.getBoundingClientRect().width;\n      const left = this.element.node.getBoundingClientRect().left;\n      this.isRightAligned = left + width > right;\n    } else this.isRightAligned = false;\n  }\n\n  get isRightAligned () {\n    return this._isRightAligned;\n  }\n\n  set isRightAligned (value) {\n    if (this._isRightAligned === value) return;\n    this._isRightAligned = value;\n    if (value) api.internals.dom.addClass(this.element.node, NavigationSelector.ITEM_RIGHT);\n    else api.internals.dom.removeClass(this.element.node, NavigationSelector.ITEM_RIGHT);\n  }\n\n  get collapsePrimary () {\n    const buttons = this.element.children.map(child => child.getInstance('CollapseButton')).filter(button => button !== null && (button.hasClass(NavigationSelector.BUTTON) || button.hasClass(NavigationSelector.TRANSLATE_BUTTON)));\n    return buttons[0];\n  }\n}\n\nexport { NavigationItem };\n","export const NavigationMousePosition = {\n  NONE: -1,\n  INSIDE: 0,\n  OUTSIDE: 1\n};\n","import api from '../../api.js';\nimport { NavigationSelector } from './navigation-selector.js';\nimport { NavigationMousePosition } from './navigation-mouse-position.js';\n\nclass Navigation extends api.core.CollapsesGroup {\n  static get instanceClassName () {\n    return 'Navigation';\n  }\n\n  init () {\n    super.init();\n    this.clicked = false;\n    this.out = false;\n    this.addEmission(api.core.RootEmission.CLICK, this._handleRootClick.bind(this));\n    this.listen('mousedown', this.handleMouseDown.bind(this));\n    this.addEmission(api.core.RootEmission.KEYDOWN, this._keydown.bind(this));\n    this.listenClick({ capture: true });\n    this.isResizing = true;\n  }\n\n  validate (member) {\n    return super.validate(member) && member.element.node.matches(api.internals.legacy.isLegacy ? NavigationSelector.COLLAPSE_LEGACY : NavigationSelector.COLLAPSE);\n  }\n\n  get hasOpenedMenu () {\n    return this.isBreakpoint(api.core.Breakpoints.LG) && this.index > -1;\n  }\n\n  _keydown (keyCode) {\n    switch (keyCode) {\n      case api.core.KeyCodes.ESCAPE:\n        if (!this.hasOpenedMenu) return;\n        this.index = -1;\n        break;\n\n      case api.core.KeyCodes.TAB:\n        if (!this.hasOpenedMenu) return;\n        this.request(() => {\n          if (this.current.node.contains(document.activeElement)) return;\n          this.index = -1;\n        });\n        break;\n    }\n  }\n\n  handleMouseDown (e) {\n    if (!this.hasOpenedMenu) return;\n    this.position = this.current.node.contains(e.target) ? NavigationMousePosition.INSIDE : NavigationMousePosition.OUTSIDE;\n    this.requestPosition();\n  }\n\n  handleClick (e) {\n    if (e.target.matches('a, button') && !e.target.matches('[aria-controls]') && !e.target.matches(api.core.DisclosureSelector.PREVENT_CONCEAL)) {\n      this.index = -1;\n    }\n  }\n\n  _handleRootClick (target) {\n    if (!this.isBreakpoint(api.core.Breakpoints.LG)) return;\n    if (!this.node.contains(target)) {\n      this.out = true;\n      this.requestPosition();\n    }\n  }\n\n  requestPosition () {\n    if (this.isRequesting) return;\n    this.isRequesting = true;\n    this.request(this.getPosition.bind(this));\n  }\n\n  getPosition () {\n    if (this.out) {\n      switch (this.position) {\n        case NavigationMousePosition.OUTSIDE:\n          this.index = -1;\n          break;\n\n        case NavigationMousePosition.INSIDE:\n          if (this.current && !this.current.node.contains(document.activeElement)) this.current.focus();\n          break;\n\n        default:\n          if (this.index > -1 && !this.current.hasFocus) this.index = -1;\n      }\n    }\n\n    this.request(this.requested.bind(this));\n  }\n\n  requested () {\n    this.position = NavigationMousePosition.NONE;\n    this.out = false;\n    this.isRequesting = false;\n  }\n\n  get index () { return super.index; }\n\n  set index (value) {\n    if (value === -1 && this.current && this.current.hasFocus) this.current.focus();\n    super.index = value;\n  }\n\n  get canUngroup () {\n    return !this.isBreakpoint(api.core.Breakpoints.LG);\n  }\n\n  resize () {\n    this.update();\n  }\n}\n\nexport { Navigation };\n","import api from './api.js';\nimport { NavigationItem } from './script/navigation/navigation-item.js';\nimport { Navigation } from './script/navigation/navigation.js';\nimport { NavigationSelector } from './script/navigation/navigation-selector.js';\nimport { NavigationMousePosition } from './script/navigation/navigation-mouse-position.js';\n\napi.navigation = {\n  Navigation: Navigation,\n  NavigationItem: NavigationItem,\n  NavigationMousePosition: NavigationMousePosition,\n  NavigationSelector: NavigationSelector\n};\n\nexport default api;\n","import api from './index.js';\n\napi.internals.register(api.navigation.NavigationSelector.NAVIGATION, api.navigation.Navigation);\napi.internals.register(api.navigation.NavigationSelector.ITEM, api.navigation.NavigationItem);\n\nexport default api;\n"],"names":["const","api","window","ITEM","internals","ns","selector","COLLAPSE","NavigationSelector","NAVIGATION","COLLAPSE_LEGACY","ITEM_RIGHT","MENU","BUTTON","TRANSLATE_BUTTON","NavigationItem","superclass","super","this","_isRightAligned","staticAccessors","instanceClassName","configurable","prototype","init","addAscent","core","DisclosureEmission","ADDED","calculate","bind","REMOVED","isResizing","resize","collapse","element","getDescendantInstances","Collapse","isBreakpoint","Breakpoints","LG","node","matches","right","parentElement","getBoundingClientRect","width","left","isRightAligned","prototypeAccessors","set","value","dom","addClass","removeClass","collapsePrimary","children","map","child","getInstance","filter","button","hasClass","Instance","NavigationMousePosition","NONE","INSIDE","OUTSIDE","Navigation","call","clicked","out","addEmission","RootEmission","CLICK","_handleRootClick","listen","handleMouseDown","KEYDOWN","_keydown","listenClick","capture","validate","member","legacy","isLegacy","hasOpenedMenu","index","keyCode","KeyCodes","ESCAPE","TAB","request","current","contains","document","activeElement","e","position","target","requestPosition","handleClick","DisclosureSelector","PREVENT_CONCEAL","isRequesting","getPosition","focus","hasFocus","requested","canUngroup","update","CollapsesGroup","navigation","register"],"mappings":"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"}