{"version":3,"file":"navigation.nomodule.min.js","sources":["../../../.config/config.js","../../../src/core/api.js","../../../src/component/navigation/script/navigation/navigation-selector.js","../../../src/component/navigation/script/navigation/navigation-item.js","../../../src/component/navigation/script/navigation/navigation-mouse-position.js","../../../src/component/navigation/script/navigation/navigation.js","../../../src/component/navigation/index.js","../../../src/component/navigation/main.js"],"sourcesContent":["const config = {\r\n  prefix: 'fr',\r\n  namespace: 'dsfr',\r\n  organisation: '@gouvfr',\r\n  version: '1.9.1'\r\n};\r\n\r\nexport default config;\r\n","import config from './config.js';\nconst api = window[config.namespace];\nexport default api;\n","import api from '../../api.js';\n\nexport const NavigationSelector = {\n  NAVIGATION: api.internals.ns.selector('nav'),\n  COLLAPSE: `${api.internals.ns.selector('nav__item')} > ${api.internals.ns.selector('collapse')}`,\n  ITEM: api.internals.ns.selector('nav__item'),\n  ITEM_RIGHT: api.internals.ns('nav__item--align-right'),\n  MENU: api.internals.ns.selector('menu')\n};\n","import api from '../../api.js';\nimport { NavigationSelector } from './navigation-selector.js';\n\nclass NavigationItem extends api.core.Instance {\n  constructor () {\n    super();\n    this._isRightAligned = false;\n  }\n\n  static get instanceClassName () {\n    return 'NavigationItem';\n  }\n\n  init () {\n    this.addAscent(api.core.DisclosureEmission.ADDED, this.calculate.bind(this));\n    this.addAscent(api.core.DisclosureEmission.REMOVED, this.calculate.bind(this));\n    this.isResizing = true;\n    this.calculate();\n  }\n\n  resize () {\n    this.calculate();\n  }\n\n  calculate () {\n    const collapse = this.element.getDescendantInstances(api.core.Collapse.instanceClassName, null, true)[0];\n    if (collapse && this.isBreakpoint(api.core.Breakpoints.LG) && collapse.element.node.matches(NavigationSelector.MENU)) {\n      const right = this.element.node.parentElement.getBoundingClientRect().right; // todo: ne fonctionne que si la nav fait 100% du container\n      const width = collapse.element.node.getBoundingClientRect().width;\n      const left = this.element.node.getBoundingClientRect().left;\n      this.isRightAligned = left + width > right;\n    } else this.isRightAligned = false;\n  }\n\n  get isRightAligned () {\n    return this._isRightAligned;\n  }\n\n  set isRightAligned (value) {\n    if (this._isRightAligned === value) return;\n    this._isRightAligned = value;\n    if (value) api.internals.dom.addClass(this.element.node, NavigationSelector.ITEM_RIGHT);\n    else api.internals.dom.removeClass(this.element.node, NavigationSelector.ITEM_RIGHT);\n  }\n}\n\nexport { NavigationItem };\n","export const NavigationMousePosition = {\n  NONE: -1,\n  INSIDE: 0,\n  OUTSIDE: 1\n};\n","import api from '../../api.js';\nimport { NavigationSelector } from './navigation-selector.js';\nimport { NavigationMousePosition } from './navigation-mouse-position.js';\n\nclass Navigation extends api.core.CollapsesGroup {\n  static get instanceClassName () {\n    return 'Navigation';\n  }\n\n  init () {\n    super.init();\n    this.clicked = false;\n    this.out = false;\n    this.listen('focusout', this.focusOutHandler.bind(this));\n    this.listen('mousedown', this.mouseDownHandler.bind(this));\n    this.listen('click', this.clickHandler.bind(this), { capture: true });\n  }\n\n  validate (member) {\n    return member.element.node.matches(NavigationSelector.COLLAPSE);\n  }\n\n  mouseDownHandler (e) {\n    if (!this.isBreakpoint(api.core.Breakpoints.LG) || this.index === -1 || !this.current) return;\n    this.position = this.current.node.contains(e.target) ? NavigationMousePosition.INSIDE : NavigationMousePosition.OUTSIDE;\n    this.requestPosition();\n  }\n\n  clickHandler (e) {\n    if (e.target.matches('a, button') && !e.target.matches('[aria-controls]') && !e.target.matches(api.core.DisclosureSelector.PREVENT_CONCEAL)) this.index = -1;\n  }\n\n  focusOutHandler (e) {\n    if (!this.isBreakpoint(api.core.Breakpoints.LG)) return;\n    this.out = true;\n    this.requestPosition();\n  }\n\n  requestPosition () {\n    if (this.isRequesting) return;\n    this.isRequesting = true;\n    this.request(this.getPosition.bind(this));\n  }\n\n  getPosition () {\n    if (this.out) {\n      switch (this.position) {\n        case NavigationMousePosition.OUTSIDE:\n          this.index = -1;\n          break;\n\n        case NavigationMousePosition.INSIDE:\n          if (this.current && !this.current.node.contains(document.activeElement)) this.current.focus();\n          break;\n\n        default:\n          if (this.index > -1 && !this.current.hasFocus) this.index = -1;\n      }\n    }\n\n    this.request(this.requested.bind(this));\n  }\n\n  requested () {\n    this.position = NavigationMousePosition.NONE;\n    this.out = false;\n    this.isRequesting = false;\n  }\n\n  get index () { return super.index; }\n\n  set index (value) {\n    if (value === -1 && this.current !== null && this.current.hasFocus) this.current.focus();\n    super.index = value;\n  }\n}\n\nexport { Navigation };\n","import api from './api.js';\nimport { NavigationItem } from './script/navigation/navigation-item.js';\nimport { Navigation } from './script/navigation/navigation.js';\nimport { NavigationSelector } from './script/navigation/navigation-selector.js';\nimport { NavigationMousePosition } from './script/navigation/navigation-mouse-position.js';\n\napi.navigation = {\n  Navigation: Navigation,\n  NavigationItem: NavigationItem,\n  NavigationMousePosition: NavigationMousePosition,\n  NavigationSelector: NavigationSelector\n};\n\nexport default api;\n","import api from './index.js';\n\napi.internals.register(api.navigation.NavigationSelector.NAVIGATION, api.navigation.Navigation);\napi.internals.register(api.navigation.NavigationSelector.ITEM, api.navigation.NavigationItem);\n\nexport default api;\n"],"names":["const","api","window","NavigationSelector","NAVIGATION","internals","ns","selector","COLLAPSE","ITEM","ITEM_RIGHT","MENU","NavigationItem","super","this","_isRightAligned","staticAccessors","instanceClassName","init","addAscent","core","DisclosureEmission","ADDED","calculate","bind","REMOVED","isResizing","resize","collapse","element","getDescendantInstances","Collapse","isBreakpoint","Breakpoints","LG","node","matches","right","parentElement","getBoundingClientRect","width","left","isRightAligned","prototypeAccessors","value","dom","addClass","removeClass","Instance","NavigationMousePosition","NONE","INSIDE","OUTSIDE","Navigation","clicked","out","listen","focusOutHandler","mouseDownHandler","clickHandler","capture","validate","member","e","index","current","position","contains","target","requestPosition","DisclosureSelector","PREVENT_CONCEAL","isRequesting","request","getPosition","document","activeElement","focus","hasFocus","requested","CollapsesGroup","navigation","register"],"mappings":"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"}